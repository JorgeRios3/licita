{% extends "account_base.html" %}
{% load formats %}
{% block account_header %}
<h1>Licitaciones</h1>
{% endblock %}

{% block account_content %}
<button id="modal_datos_comprador" style="display:none" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
    Launch demo modal
  </button>
  
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title baloo-font" id="exampleModalLabel">Datos Guardados</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body avenir-font">
          Los datos han sido guardados
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary gray-button" data-dismiss="modal">Endentido</button>
        </div>
      </div>
    </div>
  </div>




<div id="licitacion_container" style="padding-top: 100px;">
    <div class="row">
        <div class="col">
        <h2 class="baloo-font">Licitacion  {{id}}</h2>
        </div>
        <div class="col">
            <h2 class="baloo-font">Estatus: {{licitacion.status}}</h2>
        </div>
    </div>
    <div class="row">
            <div class="col">
                <b class="baloo-font" style="font-size:1.4em">{{licitacion.description}}</b>
        </div>
    </div>
    <div class="row">
        <div class="col">
            {% if request.user.id|user_has_permission:"administrador,gerente,editarDetalleLicitacion" %}
            <textarea rows="4" cols="50" id="new_comment">
            </textarea>
            <div class="row">
                <div class="col">
                    <div style="width: 196px;" class="btn btn-info blue-button" onClick="agregar_comentario({{id}})">Agregar Comentario</div>&nbsp;
                    <br>
                    <br>

                    <form method="POST" enctype="multipart/form-data" action="{% url 'add_cotizacion' id=id %}">
                        {% csrf_token %}
                        <div id="div_file">
                        <p id="boton-seccionar-cotizacion" class="baloo-font" style="padding-top:6px; font-size: 1em; font-weight: 900; padding-left: 10px;">Seleccionar Cotización</p>
                        <input type="file" name="document" id="btn_enviar">
                        </div>
                        <br>
                        <input style="width: 196px;" class="btn btn-secondary orange-button" type="submit" value="Agregar Cotización">
                    </form>
                </div>
            </div>
            {% endif %}
            <div class="row">
                <div class="col">
                    {% if licitacion.quotation != "" %}
                    <a style="padding-left: 55px;" target="_blank" href="{{licitacion.quotation}}">ver cotizacion</a>
                    {% endif %}
                </div>
            </div>
        <br>
        <div class="row"><div class="col"><b style="font-size:2em;">Comentarios</b></div></div>
        <div id="comentarios_licitacion">
            {% for x in licitacion.comments.comments %}
            <div class="row">
                <div class="col">
                    <p class="avenir-font" style="font-size: 1em;">{{x.date}} <span style="font-size: 1.2em; font-weight: bold;">{{x.comment}}</span></p>
                </div>
            </div>
            {% endfor %}
        </div>
        </div>
        <div class="col" id="comprador_container">
            <div class="row">
                <div class="col text-center"><b class="avenir-font" style="font-size:1.6em;">Datos de Comprador</b></div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="exampleInputEmail1" class="avenir-font">Nombre</label>
                    {% if licitacion.datos_comprador.nombre %}
                    <input type="email" class="form-control basic-input" id="comprador_nombre" aria-describedby="emailHelp" placeholder="Nombre" value="{{licitacion.datos_comprador.nombre}}">
                    {% else %}
                    <input type="email" class="form-control basic-input" id="comprador_nombre" aria-describedby="emailHelp" placeholder="Nombre">
                    {% endif %}
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="exampleInputEmail1" class="avenir-font">Telefono</label>
                    {% if licitacion.datos_comprador.telefono %}
                    <input type="email" class="form-control basic-input" id="comprador_telefono" aria-describedby="emailHelp" placeholder="Telefono" value="{{licitacion.datos_comprador.telefono}}">
                    {% else %}
                    <input type="email" class="form-control basic-input" id="comprador_telefono" aria-describedby="emailHelp" placeholder="Telefono">
                    {% endif %}
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="exampleInputEmail1" class="avenir-font">Email</label>
                    {% if licitacion.datos_comprador.email %}
                    <input type="email" class="form-control basic-input" id="comprador_email" aria-describedby="emailHelp" placeholder="Email" value="{{licitacion.datos_comprador.email}}">
                    {% else %}
                    <input type="email" class="form-control basic-input" id="comprador_email" aria-describedby="emailHelp" placeholder="Email">
                    {% endif %}
                </div>
            </div>
            <div class="col">
                <div class="form-group">
                    <label for="exampleInputEmail1" class="avenir-font">Direccion</label>
                    {% if licitacion.datos_comprador.direccion %}
                    <input type="email" class="form-control basic-input" id="comprador_direccion" aria-describedby="emailHelp" placeholder="Direccion" value="{{licitacion.datos_comprador.direccion}}">
                    {% else %}
                    <input type="email" class="form-control basic-input" id="comprador_direccion" aria-describedby="emailHelp" placeholder="Direccion">
                    {% endif %}
                </div>
            </div>
            {% if request.user.id|user_has_permission:"administrador,gerente,editarDetalleLicitacion" %}
            <div class="col">
                <div class="btn btn-secondary orange-button" style="margin-bottom: 50px; font-size:1.4em; height: 38px;" id="guardar_datos_comprador" onClick="guardar_datos_comprador({{id}})">Guardar</div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
